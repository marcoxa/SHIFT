% -*- Mode: LaTeX -*-

% code.sty --

% Copyright (c)1996, 1997, 1998 The Regents of the University of
% California (Regents). All Rights Reserved. 
%
% Permission to use, copy, modify, and distribute this software and its
% documentation for educational, research, and not-for-profit purposes,
% without fee and without a signed licensing agreement, is hereby
% granted, provided that the above copyright notice, this paragraph and
% the following two paragraphs appear in all copies, modifications, and
% distributions. 
%
% Contact The Office of Technology Licensing, UC Berkeley, 2150 Shattuck
% Avenue, Suite 510, Berkeley, CA 94720-1620, (510) 643-7201, for
% commercial licensing opportunities. 
%
% IN NO EVENT SHALL REGENTS BE LIABLE TO ANY PARTY FOR DIRECT, INDIRECT,
% SPECIAL, INCIDENTAL, OR CONSEQUENTIAL DAMAGES, INCLUDING LOST PROFITS,
% ARISING OUT OF THE USE OF THIS SOFTWARE AND ITS DOCUMENTATION, EVEN IF
% REGENTS HAS BEEN ADVISED OF THE POSSIBILITY OF SUCH DAMAGE. 
%
% REGENTS SPECIFICALLY DISCLAIMS ANY WARRANTIES, INCLUDING, BUT NOT
% LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR
% A PARTICULAR PURPOSE.  THE SOFTWARE AND ACCOMPANYING DOCUMENTATION, IF
% ANY, PROVIDED HEREUNDER IS PROVIDED "AS IS". REGENTS HAS NO OBLIGATION
% TO PROVIDE MAINTENANCE, SUPPORT, UPDATES, ENHANCEMENTS, OR
% MODIFICATIONS. 

%	%W% %G%

\begingroup
\catcode`\^^I=\active
\gdef\obeytabs{\catcode`\^^I=\active \def^^I{\ \ \ \ \ \ \ \ }}
\endgroup

\def\@begincode{\list{}{} \item[]\if@minipage\else\vskip\parskip\fi
\leftskip\@totalleftmargin\rightskip\z@
\parindent\z@\parfillskip\@flushglue\parskip\z@
%\newskip\oldbaselineskip\oldbaselineskip\baselineskip
\baselineskip\normalbaselineskip
\@tempswafalse \def\par{\if@tempswa\hbox{}\fi\@tempswatrue\@@par}
\obeylines \tt \catcode``=13 \@noligs
%\let\do\@makeother \dospecials
}

\def\begincode{\@begincode\frenchspacing\@vobeyspaces \obeytabs}

\newenvironment{code}
%	{\begincode}{\endlist\vskip\normalbaselineskip\vskip-\oldbaselineskip}
	{\begincode}{\endlist}


\def\@beginalgo{\list{}{} \item[]\if@minipage\else\vskip\parskip\fi
\leftskip\@totalleftmargin\rightskip\z@
\parindent\z@\parfillskip\@flushglue\parskip\z@
%\newskip\oldbaselineskip\oldbaselineskip\baselineskip
\baselineskip\normalbaselineskip
\@tempswafalse \def\par{\if@tempswa\hbox{}\fi\@tempswatrue\@@par}
\obeylines \catcode``=13
%\let\do\@makeother \dospecials
}

\def\beginalgo{\@beginalgo\frenchspacing\@vobeyspaces \obeytabs}

\newenvironment{algorithm}
%	{\beginalgo}{\endlist\vskip\normalbaselineskip\vskip-\oldbaselineskip}
	{\beginalgo}{\endlist}


\begingroup \catcode `|=0 \catcode `[= 1
\catcode`]=2 \catcode `\{=12 \catcode `\}=12
\catcode`\\=12 |gdef|@xvcode#1\end{vcode}[#1|end[vcode]]
|gdef|@sxvcode#1\end{vcode*}[[#1|endvcode*]]
|endgroup

\def\@vcode{\list{}{} \item[]\if@minipage\else\vskip\parskip\fi
\leftskip\@totalleftmargin\rightskip\z@
\parindent\z@\parfillskip\@flushglue\parskip\z@
\newskip\oldbaselineskip\oldbaselineskip\baselineskip
\baselineskip\normalbaselineskip
\@tempswafalse \def\par{\if@tempswa\hbox{}\fi\@tempswatrue\@@par}
\obeylines \tt \catcode``=13 \@noligs \let\do\@makeother \dospecials}

\def\beginvcode{\@vcode \frenchspacing\@vobeyspaces\obeytabs \@xvcode}

\newenvironment{vcode}
%	{\beginvcode}{\endlist\vskip\normalbaselineskip\vskip-\oldbaselineskip}
	{\beginvcode}{\endlist}

%----------------------------

\begingroup \catcode `|=0 \catcode `[= 1
\catcode`]=2 \catcode `\{=12 \catcode `\}=12
\catcode`\\=12 |gdef|@xucode#1\end{ucode}[#1|end[ucode]]
|gdef|@sxucode#1\end{ucode*}[[#1|enducode*]]
|endgroup

\def\@ucode{\list{}{} \item[]\if@minipage\else\vskip\parskip\fi
% \leftskip\@totalleftmargin\rightskip\z@
\parindent\z@\parfillskip\@flushglue\parskip\z@
\newskip\oldbaselineskip\oldbaselineskip\baselineskip
\baselineskip\normalbaselineskip
\@tempswafalse \def\par{\if@tempswa\hbox{}\fi\@tempswatrue\@@par}
\obeylines \tt \catcode``=13 \@noligs \let\do\@makeother \dospecials}

\def\beginucode{\@ucode \frenchspacing\@vobeyspaces\obeytabs \@xucode}
\newenvironment{ucode}  % unindented code
	{\beginucode}{\endlist}
